zabbix_export:
  version: '6.0'
  date: '2024-10-14T07:33:28Z'
  groups:
    - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    - uuid: 03e93dc9a8194a17958544a056d02316
      template: 'Microsoft 365 reports by HTTP'
      name: 'Microsoft 365 reports by HTTP'
      description: |
        This template is designed to monitor Microsoft 365 reports by HTTP. It works without any external scripts and uses script items.
        The template uses endpoints in the Microsoft Graph API to gather daily metrics from weekly reports.
        The template is meant to be used as a long-term trend monitoring tool.
        
        Setup:
          1. Register the app with Microsoft Entra ID.
          2. Configure Microsoft Graph application permissions on the app ID:
            `Reports.Read.All` - required for app usage and activity metrics
            `ServiceHealth.Read.All` - required for service discovery and service status metrics
          3. Request administrator consent.
          4. Configure the macros: `{$MS365.APP.ID}`, `{$MS365.PASSWORD}`, `{$MS365.TENANT.ID}`.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/
        
        Generated by official Zabbix template tool "Templator"
      groups:
        - name: Templates/Applications
      items:
        - uuid: 33f44ece510247938a7ccc79b5209b9f
          name: 'Apps: Activity, Exchange active users'
          type: DEPENDENT
          key: ms365.apps.activity.exchange.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Exchange users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].exchangeActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 43b10a8d427647ae9a82f6d71560bedd
          name: 'Apps: Activity, Exchange inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.exchange.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive Exchange users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].exchangeInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 004104d830b9440e9fb92fb0d289426a
          name: 'Apps: Activity, Office 365 active users'
          type: DEPENDENT
          key: ms365.apps.activity.office365.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Office 365 users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].office365Active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: dd05d33806a74a54a7640ab639a004a3
          name: 'Apps: Activity, Office 365 inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.office365.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive Office 365 users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].office365Inactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: f9b84bbc76eb4f278d32913fdcece5f4
          name: 'Apps: Activity, OneDrive active users'
          type: DEPENDENT
          key: ms365.apps.activity.onedrive.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active OneDrive users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].oneDriveActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 699122d921a046c2a652139cc982225c
          name: 'Apps: Activity, OneDrive inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.onedrive.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive OneDrive users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].oneDriveInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 245c30401bd64ba8a4dbbda7eaeab608
          name: 'Apps: Activity, report date'
          type: DEPENDENT
          key: ms365.apps.activity.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the user count by activity.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
            - tag: component
              value: date
        - uuid: 6546281eff194c048f9aaaf1cd1d2a8c
          name: 'Apps: Activity, SharePoint active users'
          type: DEPENDENT
          key: ms365.apps.activity.sharepoint.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active SharePoint users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].sharePointActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 0fdf0c1e5f1c4e94962ef76dd7377635
          name: 'Apps: Activity, SharePoint inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.sharepoint.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive SharePoint users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].sharePointInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: a977a7e3b51d42efb2c93c2269c64c91
          name: 'Apps: Activity, Skype for Business active users'
          type: DEPENDENT
          key: ms365.apps.activity.skypeforbusiness.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Skype for Business users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].skypeForBusinessActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 04f4507608b940d7a51990586cb034cd
          name: 'Apps: Activity, Skype for Business inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.skypeforbusiness.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive Skype for Business users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].skypeForBusinessInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 3a424ddd198d4cef9357daabba9937aa
          name: 'Apps: Activity, Teams active users'
          type: DEPENDENT
          key: ms365.apps.activity.teams.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Teams users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].teamsActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: f14f9730db914c7ba9162bb13c2a0882
          name: 'Apps: Activity, Teams inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.teams.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive Teams users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].teamsInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 5c3a5ebbc416479884252b1fbd787ba4
          name: 'Apps: Activity, Yammer active users'
          type: DEPENDENT
          key: ms365.apps.activity.yammer.users.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Yammer users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].yammerActive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: fe91f316df80446993e1eab32320582e
          name: 'Apps: Activity, Yammer inactive users'
          type: DEPENDENT
          key: ms365.apps.activity.yammer.users.inactive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of inactive Yammer users during the week before the report date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ServicesUserCounts[0].yammerInactive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 02333e83fd734a7b8cf699784e325242
          name: 'Apps: Get errors'
          type: DEPENDENT
          key: ms365.apps.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for Apps metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
            - tag: component
              value: error
          triggers:
            - uuid: eab5ac8df92f43398ad62a2dacb53e98
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.apps.errors))>0'
              name: 'Apps: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: d1a7d542fb44426b87a6835bb0d7990f
          name: 'Apps: Office, Excel user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.excel
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Excel users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].excel'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: b82c96446428497f906820ac786be412
          name: 'Apps: Office, OneNote user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.onenote
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active OneNote users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].oneNote'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 09555143c7874e2fa69671501d10c0c5
          name: 'Apps: Office, Outlook user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.outlook
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Outlook users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].outlook'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 3f195401fb4241c2bea951e9cae2a6b1
          name: 'Apps: Office, PowerPoint user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.powerpoint
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active PowerPoint users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].powerPoint'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 69134417295047fb9e70d6285fa7a336
          name: 'Apps: Office, user count report date'
          type: DEPENDENT
          key: ms365.apps.office.user_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of active users for each app.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
            - tag: component
              value: date
        - uuid: facc876f75db491a983cf985dfd9285d
          name: 'Apps: Office, Teams user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.teams
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Teams users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].teams'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 6d3fbb21ab084ca6a8795098048fbd11
          name: 'Apps: Office, Word user count'
          type: DEPENDENT
          key: ms365.apps.office.user_count.word
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active Word users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppUserCounts[0].userCounts[0].word'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: c78a87d0d84845d6939126af05b83d95
          name: 'Apps: Platform, Mac user count'
          type: DEPENDENT
          key: ms365.apps.platform.user_count.mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active users on the Mac platform.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppPlatformUserCounts[0].userCounts[0].mac'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 694ebc5c063d4a24b1faf7787c49e270
          name: 'Apps: Platform, mobile user count'
          type: DEPENDENT
          key: ms365.apps.platform.user_count.mobile
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active users on the mobile platform.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppPlatformUserCounts[0].userCounts[0].mobile'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 41f2b5c5140846619592e7dc8ccc3c32
          name: 'Apps: Platform, user count report date'
          type: DEPENDENT
          key: ms365.apps.platform.user_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of active users per platform.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppPlatformUserCounts[0].userCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
            - tag: component
              value: date
        - uuid: cbba35c140dc4505806b74682f30c02b
          name: 'Apps: Platform, web user count'
          type: DEPENDENT
          key: ms365.apps.platform.user_count.web
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active users on the web platform.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppPlatformUserCounts[0].userCounts[0].web'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: f8e8f4f7b1954307b2cc178367a1a8c0
          name: 'Apps: Platform, Windows user count'
          type: DEPENDENT
          key: ms365.apps.platform.user_count.windows
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active users on the Windows platform.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getM365AppPlatformUserCounts[0].userCounts[0].windows'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: f694dc8e49084d3a961c7124cb712c43
          name: 'Apps: Get reports'
          type: SCRIPT
          key: ms365.apps.reports.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            endpoints = [
            	'getOffice365ActiveUserCounts',
            	'getOffice365ServicesUserCounts',
            	'getM365AppUserCounts',
            	'getM365AppPlatformUserCounts'
            ];
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getMetricsData(endpoints));
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            Accumulated data from the Microsoft Graph API "reports" endpoints.
            More information:
            https://learn.microsoft.com/en-us/graph/api/resources/report?view=graph-rest-beta
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: apps
            - tag: component
              value: raw
        - uuid: 229db8688139475bbb61dee9567f07a0
          name: 'Apps: Users, Exchange'
          type: DEPENDENT
          key: ms365.apps.users.exchange
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily Exchange users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].exchange'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 2f7a16de43c24f3f89e62606f3a2c900
          name: 'Apps: Users, Office 365'
          type: DEPENDENT
          key: ms365.apps.users.office365
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily Office 365 users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].office365'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: c0108adb522245bda915ce523624091d
          name: 'Apps: Users, OneDrive'
          type: DEPENDENT
          key: ms365.apps.users.onedrive
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily OneDrive users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].oneDrive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: baf254f6a7d34ebc89824a6b9631025a
          name: 'Apps: Users, report date'
          type: DEPENDENT
          key: ms365.apps.users.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the active user count report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
            - tag: component
              value: date
        - uuid: 855d1296c4a2470f9e1c56d0b887b5bc
          name: 'Apps: Users, SharePoint'
          type: DEPENDENT
          key: ms365.apps.users.sharepoint
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily SharePoint users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].sharePoint'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 8de7670a3d57464897db996620638edd
          name: 'Apps: Users, Skype for Business'
          type: DEPENDENT
          key: ms365.apps.users.skype
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily Skype for Business users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].skypeForBusiness'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 27ea23488a6f4660a5335a802995071d
          name: 'Apps: Users, Teams'
          type: DEPENDENT
          key: ms365.apps.users.teams
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily Teams users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].teams'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: a9212ec491ac4b57ae1d1242abd5fa29
          name: 'Apps: Users, Yammer'
          type: DEPENDENT
          key: ms365.apps.users.yammer
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of daily Yammer users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOffice365ActiveUserCounts[6].yammer'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.apps.reports.get
          tags:
            - tag: component
              value: apps
        - uuid: 8ed3af9876f94f138a0f6e19ea02235a
          name: 'OneDrive: Get errors'
          type: DEPENDENT
          key: ms365.onedrive.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for OneDrive metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: error
            - tag: component
              value: onedrive
          triggers:
            - uuid: b526cc91e49041a1ba4fac76b8f464c2
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.onedrive.errors))>0'
              name: 'OneDrive: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: e7e2570b2b124cd08b21b065f95ae8d7
          name: 'OneDrive: Files, activity, report date'
          type: DEPENDENT
          key: ms365.onedrive.files.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of report of the number of active OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityFileCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: onedrive
        - uuid: ee6d3acbdd674f479cd6c99a2f113e2e
          name: 'OneDrive: Files, shared externally'
          type: DEPENDENT
          key: ms365.onedrive.files.shared_externally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of externally shared OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityFileCounts[0].sharedExternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: b94ba3d65ebd4bcca434c54a7252739c
          name: 'OneDrive: Files, shared internally'
          type: DEPENDENT
          key: ms365.onedrive.files.shared_internally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of internally shared OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityFileCounts[0].sharedInternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 35327a7d610a442d87b1672532b9ada3
          name: 'OneDrive: Files, synced'
          type: DEPENDENT
          key: ms365.onedrive.files.synced
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of synced OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityFileCounts[0].synced'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 86e92424c4a946768f48fe757ea1883e
          name: 'OneDrive: Files, viewed or edited'
          type: DEPENDENT
          key: ms365.onedrive.files.viewed_or_edited
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of viewed or edited OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityFileCounts[0].viewedOrEdited'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: e6a94bc310e142ccaa398533c2161e43
          name: 'OneDrive: File count, active'
          type: DEPENDENT
          key: ms365.onedrive.file_count.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The total number of active files across all sites. A file is considered active if it has been saved, synced, modified, or shared.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageFileCounts[0].active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 24d396224317427080e538897d7bdc81
          name: 'OneDrive: File count, report date'
          type: DEPENDENT
          key: ms365.onedrive.file_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the OneDrive file count report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageFileCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: onedrive
        - uuid: 4413b1514364430f9846aa952893b2d4
          name: 'OneDrive: File count, total'
          type: DEPENDENT
          key: ms365.onedrive.file_count.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The total number of files across all sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageFileCounts[0].total'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 31b78185119446f397404ae7abf05684
          name: 'OneDrive: Get reports'
          type: SCRIPT
          key: ms365.onedrive.reports.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            const endpoints = [
            	'getOneDriveActivityUserCounts',
            	'getOneDriveActivityFileCounts',
            	'getOneDriveUsageAccountCounts',
            	'getOneDriveUsageFileCounts',
            	'getOneDriveUsageStorage'
            ];
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getMetricsData(endpoints));
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            Accumulated data from the Microsoft Graph API "reports" endpoints.
            More information:
            https://learn.microsoft.com/en-us/graph/api/resources/report?view=graph-rest-beta
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: onedrive
            - tag: component
              value: raw
        - uuid: b32aba6af3444230b9bd06ba8544c906
          name: 'OneDrive: Business sites, active'
          type: DEPENDENT
          key: ms365.onedrive.sites.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active OneDrive for Business sites. Any site on which users have viewed, modified, uploaded, downloaded, shared, or synced files is considered an active site.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageAccountCounts[0].active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 023d27c3fbbc4228b374ddec9cc8e35b
          name: 'OneDrive: Business sites, report date'
          type: DEPENDENT
          key: ms365.onedrive.sites.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the number of OneDrive for Business sites report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageAccountCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: onedrive
        - uuid: c15eff389f904d9798fe7935d8ce9328
          name: 'OneDrive: Business sites, total'
          type: DEPENDENT
          key: ms365.onedrive.sites.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of OneDrive for Business sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageAccountCounts[0].total'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 4482652327664e8fab8301ec559fa897
          name: 'OneDrive: Storage, report date'
          type: DEPENDENT
          key: ms365.onedrive.storage.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the amount of storage used in OneDrive for Business.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageStorage[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: onedrive
        - uuid: dfcbbd4b82f549fb926ddabef52317ca
          name: 'OneDrive: Storage, total'
          type: DEPENDENT
          key: ms365.onedrive.storage.total
          delay: '0'
          history: 7d
          trends: '0'
          units: B
          description: 'The total amount of storage used in OneDrive for Business.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveUsageStorage[?(@.siteType == "All")].storageUsedInBytes.first()'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 5bd03a64dfa94cfe9f279219fdca22ff
          name: 'OneDrive: Users, report date'
          type: DEPENDENT
          key: ms365.onedrive.users.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of active OneDrive users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityUserCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: onedrive
        - uuid: 36ed7c38f7d544968830e876e6e6b24d
          name: 'OneDrive: Users, shared externally'
          type: DEPENDENT
          key: ms365.onedrive.users.shared_externally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have shared OneDrive files externally.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityUserCounts[0].sharedExternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: d393a09d304a4cb2b4bc4faa75361962
          name: 'OneDrive: Users, shared internally'
          type: DEPENDENT
          key: ms365.onedrive.users.shared_internally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have shared OneDrive files internally.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityUserCounts[0].sharedInternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 463d39ac2dee4bd09bd9547d269fc0cd
          name: 'OneDrive: Users, synced'
          type: DEPENDENT
          key: ms365.onedrive.users.synced
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have synced OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityUserCounts[0].synced'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: 5e68a062cb2e40508f7d65bc5c07e5f6
          name: 'OneDrive: Users, viewed or edited'
          type: DEPENDENT
          key: ms365.onedrive.users.viewed_or_edited
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have viewed or edited OneDrive files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getOneDriveActivityUserCounts[0].viewedOrEdited'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.onedrive.reports.get
          tags:
            - tag: component
              value: onedrive
        - uuid: b1e7a98c1fd04a6da30b2572e440a90f
          name: 'Outlook: Activity, meetings created'
          type: DEPENDENT
          key: ms365.outlook.activity.meetings_created
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of times a "Meeting request sent" action was recorded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].meetingCreated'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 0b6090e26675480eadffb518685398a7
          name: 'Outlook: Activity, meetings interacted'
          type: DEPENDENT
          key: ms365.outlook.activity.meetings_interacted
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of times a meeting request accept, tentative, decline, or cancel action was recorded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].meetingInteracted'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: c8692fab4c5e4af1860beca648a5fa7e
          name: 'Outlook: Activity, emails read'
          type: DEPENDENT
          key: ms365.outlook.activity.read
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of times an "Email read" action was recorded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].read'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 0e205e2458f047399e682bfa68881395
          name: 'Outlook: Activity, emails received'
          type: DEPENDENT
          key: ms365.outlook.activity.received
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of times an "Email received" action was recorded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].receive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 6eb5581fba9e4613b1e966852bb166cc
          name: 'Outlook: Activity, report date'
          type: DEPENDENT
          key: ms365.outlook.activity.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the Outlook activity count report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: outlook
        - uuid: b090b886df704dc3baf0d6e7eb4d08f8
          name: 'Outlook: Activity, emails sent'
          type: DEPENDENT
          key: ms365.outlook.activity.sent
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of times an "Email sent" action was recorded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityCounts[0].send'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 2acaed1cc8fc4111ad71a38d4ae2f004
          name: 'Outlook: Get errors'
          type: DEPENDENT
          key: ms365.outlook.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for Outlook metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: error
            - tag: component
              value: outlook
          triggers:
            - uuid: 79d0d9d9622347e2a7c937b7831ac01b
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.outlook.errors))>0'
              name: 'Outlook: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 37e6321c075945c5b06bc77783bd5b73
          name: 'Outlook: Mailbox, active'
          type: DEPENDENT
          key: ms365.outlook.mailbox.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active user mailboxes in your organization. A mailbox is considered active if the user has sent or read any emails.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getMailboxUsageMailboxCounts[0].active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 637165130fc44abcafcc84366929f74e
          name: 'Outlook: Mailbox, active in %'
          type: DEPENDENT
          key: ms365.outlook.mailbox.active.percentage
          delay: '0'
          history: 7d
          trends: '0'
          value_type: FLOAT
          units: '%'
          description: 'Percentage of active user mailboxes in your organization. A mailbox is considered active if the user has sent or read any emails.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getMailboxUsageMailboxCounts[0].active * 100 / data.metrics.getMailboxUsageMailboxCounts[0].total;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 292361cb20a84d028003732027405882
          name: 'Outlook: Mailbox, report date'
          type: DEPENDENT
          key: ms365.outlook.mailbox.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the unique user count per app.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getMailboxUsageMailboxCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: outlook
        - uuid: 5eec6999430b4dcb87fdf54162839e42
          name: 'Outlook: Mailbox, total'
          type: DEPENDENT
          key: ms365.outlook.mailbox.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The total number of user mailboxes in your organization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getMailboxUsageMailboxCounts[0].total'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 4e4d78bd44db421a908288031489c3d4
          name: 'Outlook: Get reports'
          type: SCRIPT
          key: ms365.outlook.reports.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            endpoints = [
            	'getEmailActivityCounts',
            	'getEmailActivityUserCounts',
            	'getEmailAppUsageUserCounts',
            	'getMailboxUsageMailboxCounts',
            	'getMailboxUsageStorage'
            ];
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getMetricsData(endpoints));
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            Accumulated data from the Microsoft Graph API "reports" endpoints.
            More information:
            https://learn.microsoft.com/en-us/graph/api/resources/report?view=graph-rest-beta
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: outlook
            - tag: component
              value: raw
        - uuid: d633c87e65574b2a9453c48efc899368
          name: 'Outlook: Mailbox, storage, report date'
          type: DEPENDENT
          key: ms365.outlook.storage.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the mailbox storage report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getMailboxUsageStorage[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: outlook
        - uuid: e57fc3c97fca4fb2ac806be8548c69c2
          name: 'Outlook: Mailbox, storage used'
          type: DEPENDENT
          key: ms365.outlook.storage.used
          delay: '0'
          history: 7d
          trends: '0'
          units: B
          description: 'The amount of mailbox storage used in your organization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getMailboxUsageStorage[0].storageUsedInBytes'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 866cc243422f4494a53f731189de97b0
          name: 'Outlook: User count, IMAP4 applications'
          type: DEPENDENT
          key: ms365.outlook.user_count.imap4app
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of other IMAP4 applications.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].imap4App'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 7cafa2052df1426d8ca136b02d517166
          name: 'Outlook: User count, Outlook for Mac'
          type: DEPENDENT
          key: ms365.outlook.user_count.mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of Outlook for Mac.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].outlookForMac'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: b0192e926ec44808a89423ed0231d858
          name: 'Outlook: User count, mail for Mac'
          type: DEPENDENT
          key: ms365.outlook.user_count.mail_for_mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of mail for Mac.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].mailForMac'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 3df9660d9f764c26bf281041aae2466e
          name: 'Outlook: User count, meetings created'
          type: DEPENDENT
          key: ms365.outlook.user_count.meetings_created
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users a "Meeting request sent" action was recorded for.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].meetingCreated'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 50703e1aec3d47218d08495f2c7112c2
          name: 'Outlook: User count, meetings interacted'
          type: DEPENDENT
          key: ms365.outlook.user_count.meetings_interacted
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users a meeting request accept, tentative, decline, or cancel action was recorded for.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].meetingInteracted'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 9afd7131c46043dbac392b22f042edcc
          name: 'Outlook: User count, Outlook for mobile'
          type: DEPENDENT
          key: ms365.outlook.user_count.mobile
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of Outlook for mobile.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].outlookForMobile'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: c832f65eb47d4fe69824296994bd39e7
          name: 'Outlook: User count, POP3 applications'
          type: DEPENDENT
          key: ms365.outlook.user_count.pop3app
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of other POP3 applications.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].pop3App'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 9f612d7d0f3c45c6a12bab26609a31ba
          name: 'Outlook: User count, emails read'
          type: DEPENDENT
          key: ms365.outlook.user_count.read
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users an "Email read" action was recorded for.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].read'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 2f6ca8ba75da45d2ac91af9e526e411d
          name: 'Outlook: User count, emails received'
          type: DEPENDENT
          key: ms365.outlook.user_count.received
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users an "Email received" action was recorded for.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].receive'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 9798b94176294350a4c6f9de40839c3f
          name: 'Outlook: User count, report date'
          type: DEPENDENT
          key: ms365.outlook.user_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the Outlook activity user count report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: outlook
        - uuid: d4835c7b293845c9a28d7c4ee4d25d01
          name: 'Outlook: User count, app usage, report date'
          type: DEPENDENT
          key: ms365.outlook.user_count.report_date.app
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the unique user count per app.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: outlook
        - uuid: 176af3cbc220429dbed826714cf4374d
          name: 'Outlook: User count, emails sent'
          type: DEPENDENT
          key: ms365.outlook.user_count.sent
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users an "Email sent" action was recorded for.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailActivityUserCounts[0].send'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 48e8bcbc05bb488784da9630a8a05565
          name: 'Outlook: User count, SMTP applications'
          type: DEPENDENT
          key: ms365.outlook.user_count.smtpapp
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of other SMTP applications.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].smtpApp'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 031244dc15cc4eccb75be311a84d2c74
          name: 'Outlook: User count, Outlook for web'
          type: DEPENDENT
          key: ms365.outlook.user_count.web
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of Outlook for web.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].outlookForWeb'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: 01f6f3d0946548e086df06ea90a16c84
          name: 'Outlook: User count, Outlook for Windows'
          type: DEPENDENT
          key: ms365.outlook.user_count.windows
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique users of Outlook for Windows.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getEmailAppUsageUserCounts[6].outlookForWindows'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.outlook.reports.get
          tags:
            - tag: component
              value: outlook
        - uuid: b547935175f441f2a3a2bf41c8abc99b
          name: 'Services: Get errors'
          type: DEPENDENT
          key: ms365.services.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for Services metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.services.get
          tags:
            - tag: component
              value: error
            - tag: component
              value: service
          triggers:
            - uuid: 54c11aad4113433a866272988a64c2bf
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.services.errors))>0'
              name: 'Services: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 53c72fa948454b998f612c4d099dd440
          name: 'Services: Get services'
          type: SCRIPT
          key: ms365.services.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getServiceData());
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            The list of Microsoft cloud services and their health statuses subscribed by a tenant.
            More information:
            https://learn.microsoft.com/en-us/graph/api/servicehealth-get?view=graph-rest-beta&tabs=http
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: service
        - uuid: d4256e411ced4566b9abea622acbbf6d
          name: 'SharePoint: Get errors'
          type: DEPENDENT
          key: ms365.sharepoint.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for SharePoint metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: error
            - tag: component
              value: sharepoint
          triggers:
            - uuid: af3d4e3b2ca84ad39780d6d5e13afdee
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.sharepoint.errors))>0'
              name: 'SharePoint: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 2d9db2f1db4741a6a2afb9088cf31218
          name: 'SharePoint: Files, activity, report date'
          type: DEPENDENT
          key: ms365.sharepoint.files.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of active SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityFileCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 0fa7e6c2f6eb46da8ee577fd88d502b2
          name: 'SharePoint: Files, shared externally'
          type: DEPENDENT
          key: ms365.sharepoint.files.shared_externally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of externally shared SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityFileCounts[0].sharedExternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: dba7c4e8e1244edfa2e227d5db8f89cc
          name: 'SharePoint: Files, shared internally'
          type: DEPENDENT
          key: ms365.sharepoint.files.shared_internally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of internally shared SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityFileCounts[0].sharedInternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 72cdf53a7fc04b01ac47f7fad3dc1973
          name: 'SharePoint: Files, synced'
          type: DEPENDENT
          key: ms365.sharepoint.files.synced
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of files synced to a SharePoint site.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityFileCounts[0].synced'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 8a26811f0bdc4f7baab93a87e76bfd78
          name: 'SharePoint: Files, viewed or edited'
          type: DEPENDENT
          key: ms365.sharepoint.files.viewed_or_edited
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of viewed or edited SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityFileCounts[0].viewedOrEdited'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: ef4edb2188b244858f2f052a5880877d
          name: 'SharePoint: File count, active'
          type: DEPENDENT
          key: ms365.sharepoint.file_count.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The total number of active files across all sites. A file is considered active if it has been saved, synced, modified, or shared.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageFileCounts[0].active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 0f919b2dba8c42a1b14425fe0d28a27f
          name: 'SharePoint: File count, report date'
          type: DEPENDENT
          key: ms365.sharepoint.file_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the SharePoint file count report.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageFileCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 9a79514b201a4c6b9721ef9188d234e1
          name: 'SharePoint: File count, total'
          type: DEPENDENT
          key: ms365.sharepoint.file_count.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The total number of files across all sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageFileCounts[0].total'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 05e43c1b8a7d4d4abe773c3129c0100a
          name: 'SharePoint: Pages, view count'
          type: DEPENDENT
          key: ms365.sharepoint.pages_viewed.count
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of pages viewed across all sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsagePages[0].pageViewCount'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 58cb9338fa684f9f9631a6f3f8736469
          name: 'SharePoint: Pages, viewed, report date'
          type: DEPENDENT
          key: ms365.sharepoint.pages_viewed.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of pages viewed.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsagePages[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 71f0ccd4e8a846009dd9b81392f3330c
          name: 'SharePoint: Pages, visited'
          type: DEPENDENT
          key: ms365.sharepoint.pages_visited.count
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique pages visited by users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityPages[0].visitedPageCount'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: de53a4cec0fb42c4bdee64a1539876c7
          name: 'SharePoint: Pages, visited, report date'
          type: DEPENDENT
          key: ms365.sharepoint.pages_visited.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of pages visited.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityPages[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: fd2cb544cfd744c1a94a1d32243978e6
          name: 'SharePoint: Get reports'
          type: SCRIPT
          key: ms365.sharepoint.reports.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            endpoints = [
            	'getSharePointActivityFileCounts',
            	'getSharePointActivityUserCounts',
            	'getSharePointActivityPages',
            	'getSharePointSiteUsageFileCounts',
            	'getSharePointSiteUsageSiteCounts',
            	'getSharePointSiteUsageStorage',
            	'getSharePointSiteUsagePages'
            ];
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getMetricsData(endpoints));
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            Accumulated data from the Microsoft Graph API "reports" endpoints.
            More information:
            https://learn.microsoft.com/en-us/graph/api/resources/report?view=graph-rest-beta
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: sharepoint
        - uuid: e17280ef24ff426fb2dbf3fb0c7beaa4
          name: 'SharePoint: Sites, report date'
          type: DEPENDENT
          key: ms365.sharepoint.site.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of SharePoint sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageSiteCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 92930bce83b449b4963ea8e27ed4bb33
          name: 'SharePoint: Sites, active'
          type: DEPENDENT
          key: ms365.sharepoint.sites.active
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active SharePoint sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageSiteCounts[0].active'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: ea038226a3c34a8eada1836f08a9a17b
          name: 'SharePoint: Sites, total'
          type: DEPENDENT
          key: ms365.sharepoint.sites.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of SharePoint sites.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageSiteCounts[0].total'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 2feda0c4073445bcbe6a99e1eed1b838
          name: 'SharePoint: Storage, report date'
          type: DEPENDENT
          key: ms365.sharepoint.storage.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the amount of storage used in SharePoint.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageStorage[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 18e892b6167442ec9c385cee5b1d919c
          name: 'SharePoint: Storage, total'
          type: DEPENDENT
          key: ms365.sharepoint.storage.total
          delay: '0'
          history: 7d
          trends: '0'
          units: B
          description: 'The total amount of storage used in SharePoint.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointSiteUsageStorage[0].storageUsedInBytes'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 9cffe16ecb9347ddb59afd577996e676
          name: 'SharePoint: Users, report date'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of active SharePoint users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].reportDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: sharepoint
        - uuid: 11bd113ce58b4d95a4b75965ede4f7f3
          name: 'SharePoint: Users, shared externally'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.shared_externally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have shared SharePoint files externally.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].sharedExternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 08ad2690bc3c4c2eb88094754a7b3044
          name: 'SharePoint: Users, shared internally'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.shared_internally
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have shared SharePoint files internally.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].sharedInternally'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: a632ededd9794a1f97c8d06caefb6965
          name: 'SharePoint: Users, synced'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.synced
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have synced SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].synced'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 234db342146044399cb243376b81f571
          name: 'SharePoint: Users, viewed or edited'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.viewed_or_edited
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have viewed or edited SharePoint files.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].viewedOrEdited'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: f6883d5517054554b3553e3497925c58
          name: 'SharePoint: Users, pages visited'
          type: DEPENDENT
          key: ms365.sharepoint.user_count.visited_page
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of users who have visited unique pages.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getSharePointActivityUserCounts[0].visitedPage'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.sharepoint.reports.get
          tags:
            - tag: component
              value: sharepoint
        - uuid: 34bfd72749ec4b8d9e6bb305a6d105b5
          name: 'Teams: Team activity, active channels'
          type: DEPENDENT
          key: ms365.teams.activity.team.active_channels
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active channels across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].activeChannels'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 8b87fb80bc274241861d2d4683deb16a
          name: 'Teams: Team activity, active external users'
          type: DEPENDENT
          key: ms365.teams.activity.team.active_external_users
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active external users across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].activeExternalUsers'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 329e2462f6c3461aa839d234e69137d1
          name: 'Teams: Team activity, active shared channels'
          type: DEPENDENT
          key: ms365.teams.activity.team.active_shared_channels
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active shared channels across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].activeSharedChannels'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 9297ac6f704249b189a826ca113624dd
          name: 'Teams: Team activity, active users'
          type: DEPENDENT
          key: ms365.teams.activity.team.active_users
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of active users across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].activeUsers'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 88e359b530424573ab9ffa9703648886
          name: 'Teams: Team activity, channel messages'
          type: DEPENDENT
          key: ms365.teams.activity.team.channel_messages
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of channel messages across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].channelMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: ba3d03da9c184f9fb4451eda4b9fb013
          name: 'Teams: Team activity, guests'
          type: DEPENDENT
          key: ms365.teams.activity.team.guests
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of guests across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].guests'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: e46f6cc21cdd479581f52d34fba062b9
          name: 'Teams: Team activity, meetings organized'
          type: DEPENDENT
          key: ms365.teams.activity.team.meetings_organized
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of organized meetings across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].meetingsOrganized'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 49f96c1827e744158c70654b0a1d9933
          name: 'Teams: Team activity, mentions'
          type: DEPENDENT
          key: ms365.teams.activity.team.mentions
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of mentions across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].mentions'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 222be36f3ef84bc281d125ef0609ec82
          name: 'Teams: Team activity, post messages'
          type: DEPENDENT
          key: ms365.teams.activity.team.messages.posts
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of post messages across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].postMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 823acbc537544d89a8411025d1624715
          name: 'Teams: Team activity, reply messages'
          type: DEPENDENT
          key: ms365.teams.activity.team.messages.replies
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of reply messages across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].replyMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 0f9ae923e0694e149e441c7c48c5e13d
          name: 'Teams: Team activity, reactions'
          type: DEPENDENT
          key: ms365.teams.activity.team.reactions
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of reactions across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].reactions'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 83f8432b7ab246e59da295fa50294c78
          name: 'Teams: Team activity, report date'
          type: DEPENDENT
          key: ms365.teams.activity.team.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of team activities.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: teams
        - uuid: 3d76b28d9ce048f59ab49e722a576cbe
          name: 'Teams: Team activity, urgent messages'
          type: DEPENDENT
          key: ms365.teams.activity.team.urgent_messages
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of urgent messages across Microsoft Teams over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsTeamActivityDistributionCounts[0].activityDistributions[0].urgentMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: ba7e5388f43b40c1bd63516c1edb995d
          name: 'Teams: User activity, calls'
          type: DEPENDENT
          key: ms365.teams.activity.user.calls
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of 1:1 calls licensed or non-licensed Microsoft Teams users participated in during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].calls'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: e17c33e6ea724db1884ba8b8519050e5
          name: 'Teams: User activity, audio duration'
          type: DEPENDENT
          key: ms365.teams.activity.user.duration.audio
          delay: '0'
          history: 7d
          trends: '0'
          units: s
          description: 'The sum of the audio duration of licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].audioDuration'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
            - type: JAVASCRIPT
              parameters:
                - |
                  function iso8601DurationToSeconds(iso8601Duration) {
                  	const iso8601DurationRegex = /(-)?P(?:([.,\d]+)Y)?(?:([.,\d]+)M)?(?:([.,\d]+)W)?(?:([.,\d]+)D)?(?:T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?)?/;
                  	const matches = iso8601Duration.match(iso8601DurationRegex);
                  
                  	duration = 0;
                  	matches.forEach( function (field, index) {
                  		if (field != undefined) {
                  			switch(index) {
                  				case 2: duration += parseInt(field) * daysInThisYear() * 86400; break;
                  				case 3: duration += parseInt(field) * daysInThisMonth() * 86400; break;
                  				case 4: duration += parseInt(field) * 604800; break;
                  				case 5: duration += parseInt(field) * 86400; break;
                  				case 6: duration += parseInt(field) * 3600; break;
                  				case 7: duration += parseInt(field) * 60; break;
                  				case 8: duration += parseInt(field);
                  			}
                  		}
                  	});
                  
                  	return duration;
                  };
                  
                  function daysInThisMonth() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
                  };
                  
                  function daysInThisYear() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), 2, 0).getDate() + 337;
                  };
                  
                  return iso8601DurationToSeconds(value);
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: ab085552326c4e51847ec6f51377601e
          name: 'Teams: User activity, screen share duration'
          type: DEPENDENT
          key: ms365.teams.activity.user.duration.screen_share
          delay: '0'
          history: 7d
          trends: '0'
          units: s
          description: 'The sum of the screen share duration of licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].screenShareDuration'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
            - type: JAVASCRIPT
              parameters:
                - |
                  function iso8601DurationToSeconds(iso8601Duration) {
                  	const iso8601DurationRegex = /(-)?P(?:([.,\d]+)Y)?(?:([.,\d]+)M)?(?:([.,\d]+)W)?(?:([.,\d]+)D)?(?:T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?)?/;
                  	const matches = iso8601Duration.match(iso8601DurationRegex);
                  
                  	duration = 0;
                  	matches.forEach( function (field, index) {
                  		if (field != undefined) {
                  			switch(index) {
                  				case 2: duration += parseInt(field) * daysInThisYear() * 86400; break;
                  				case 3: duration += parseInt(field) * daysInThisMonth() * 86400; break;
                  				case 4: duration += parseInt(field) * 604800; break;
                  				case 5: duration += parseInt(field) * 86400; break;
                  				case 6: duration += parseInt(field) * 3600; break;
                  				case 7: duration += parseInt(field) * 60; break;
                  				case 8: duration += parseInt(field);
                  			}
                  		}
                  	});
                  
                  	return duration;
                  };
                  
                  function daysInThisMonth() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
                  };
                  
                  function daysInThisYear() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), 2, 0).getDate() + 337;
                  };
                  
                  return iso8601DurationToSeconds(value);
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 50d50c7daccc4eafb3d98fd5de233ba2
          name: 'Teams: User activity, video duration'
          type: DEPENDENT
          key: ms365.teams.activity.user.duration.video
          delay: '0'
          history: 7d
          trends: '0'
          units: s
          description: 'The sum of the video duration of licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].videoDuration'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
            - type: JAVASCRIPT
              parameters:
                - |
                  function iso8601DurationToSeconds(iso8601Duration) {
                  	const iso8601DurationRegex = /(-)?P(?:([.,\d]+)Y)?(?:([.,\d]+)M)?(?:([.,\d]+)W)?(?:([.,\d]+)D)?(?:T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?)?/;
                  	const matches = iso8601Duration.match(iso8601DurationRegex);
                  
                  	duration = 0;
                  	matches.forEach( function (field, index) {
                  		if (field != undefined) {
                  			switch(index) {
                  				case 2: duration += parseInt(field) * daysInThisYear() * 86400; break;
                  				case 3: duration += parseInt(field) * daysInThisMonth() * 86400; break;
                  				case 4: duration += parseInt(field) * 604800; break;
                  				case 5: duration += parseInt(field) * 86400; break;
                  				case 6: duration += parseInt(field) * 3600; break;
                  				case 7: duration += parseInt(field) * 60; break;
                  				case 8: duration += parseInt(field);
                  			}
                  		}
                  	});
                  
                  	return duration;
                  };
                  
                  function daysInThisMonth() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
                  };
                  
                  function daysInThisYear() {
                  	const now = new Date();
                  
                  	return new Date(now.getFullYear(), 2, 0).getDate() + 337;
                  };
                  
                  return iso8601DurationToSeconds(value);
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 580aa03b32364b648e2068ac2db70400
          name: 'Teams: User activity, attended meetings'
          type: DEPENDENT
          key: ms365.teams.activity.user.meetings.attended
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The sum of the scheduled one-time and recurring, ad-hoc, and unclassified meetings attended by licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].meetingsAttended'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: eb8bef4579a44ad381808574be6d20e9
          name: 'Teams: User activity, organized meetings'
          type: DEPENDENT
          key: ms365.teams.activity.user.meetings.organized
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The sum of the scheduled one-time and recurring, ad-hoc, and unclassified meetings organized by licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].meetingsOrganized'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 72a82b9a3b594f2abda27e21718cc937
          name: 'Teams: User activity, meetings'
          type: DEPENDENT
          key: ms365.teams.activity.user.meetings.total
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The sum of the scheduled one-time and recurring, ad-hoc, and unclassified meetings licensed or non-licensed Microsoft Teams users participated in during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].meetings'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 1c667ffc4f744a838ba4a82664507b8a
          name: 'Teams: User activity, team chat messages'
          type: DEPENDENT
          key: ms365.teams.activity.user.messages.in_team
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique messages that were posted in team chats by licensed or non-licensed Microsoft Teams users during the week before the report refresh date. This includes original posts and replies.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].teamChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 7b21ea233e5242a0bdafe3c9d190b2a1
          name: 'Teams: User activity, post messages'
          type: DEPENDENT
          key: ms365.teams.activity.user.messages.posts
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of post messages in all channels made by licensed or non-licensed Microsoft Teams users during the week before the report refresh date. A post is the original message in a teams chat.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].postMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: b833bc817058414fa44ee68b91cb729d
          name: 'Teams: User activity, private chat messages'
          type: DEPENDENT
          key: ms365.teams.activity.user.messages.private
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique messages that were posted in private chats by licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].privateChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: ef4c68446d674310aebdc8da9d20002e
          name: 'Teams: User activity, reply messages'
          type: DEPENDENT
          key: ms365.teams.activity.user.messages.replies
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of reply messages in all channels made by licensed or non-licensed Microsoft Teams users during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].userCounts[0].replyMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 16098eacf17a4fa4a1704b0b87ee4f5e
          name: 'Teams: User activity, report date'
          type: DEPENDENT
          key: ms365.teams.activity.user.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of activities by all users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityTotalDistributionCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: teams
        - uuid: dec6dfcf6d1040999633356029597861
          name: 'Teams: Device usage (guests), Android'
          type: DEPENDENT
          key: ms365.teams.device.guests.android
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams mobile client for Android over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].androidPhone - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].androidPhone;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: f69460d4a5b64cdfb1d46d108ee0f703
          name: 'Teams: Device usage (guests), Chrome OS'
          type: DEPENDENT
          key: ms365.teams.device.guests.chromeos
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams desktop client on a ChromeOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].chromeOS - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].chromeOS;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: c425439d85834854b702dcca49c84579
          name: 'Teams: Device usage (guests), iOS'
          type: DEPENDENT
          key: ms365.teams.device.guests.ios
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams mobile client for iOS over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].ios - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].ios;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 90b8cfc7f64944599cf756fc4e8cb72c
          name: 'Teams: Device usage (guests), Linux'
          type: DEPENDENT
          key: ms365.teams.device.guests.linux
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams desktop client on a Linux computer over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].linux - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].linux;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 60b11d13d4e74476a0e48832d6bc9f79
          name: 'Teams: Device usage (guests), Mac'
          type: DEPENDENT
          key: ms365.teams.device.guests.mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams desktop client on a macOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].mac - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].mac;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: bda18a4088f940c1b36510fd135819aa
          name: 'Teams: Device usage (guests), web client'
          type: DEPENDENT
          key: ms365.teams.device.guests.web
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams web client over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].web - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].web;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: d62bfc1f1a7b4480bbf10659782c3ea2
          name: 'Teams: Device usage (guests), Windows'
          type: DEPENDENT
          key: ms365.teams.device.guests.windows
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique non-licensed Microsoft Teams users (guests) recorded via the Teams desktop client on a Windows-based computer over the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].windows - data.metrics.getTeamsDeviceUsageDistributionUserCounts[0].windows;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: b7b407ce61984b5ba717dfb0ff50c369
          name: 'Teams: Device usage (total), Android'
          type: DEPENDENT
          key: ms365.teams.device.total.android
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams mobile client for Android over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].androidPhone'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 5bef589815d241b49456676c8fa065f8
          name: 'Teams: Device usage (total), Chrome OS'
          type: DEPENDENT
          key: ms365.teams.device.total.chromeos
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams desktop client on a ChromeOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].chromeOS'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 063563a9f8964f6f8c7a518a4ebbec4d
          name: 'Teams: Device usage (total), iOS'
          type: DEPENDENT
          key: ms365.teams.device.total.ios
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams mobile client for iOS over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].ios'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: aeb3d4065bc34d74a592daa8bc72f353
          name: 'Teams: Device usage (total), Linux'
          type: DEPENDENT
          key: ms365.teams.device.total.linux
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams desktop client on a Linux computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].linux'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 090671fa6fc945a391080eb44df88223
          name: 'Teams: Device usage (total), Mac'
          type: DEPENDENT
          key: ms365.teams.device.total.mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams desktop client on a macOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].mac'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 5b7f0955910a46e8996614c52df16792
          name: 'Teams: Device usage (total), report date'
          type: DEPENDENT
          key: ms365.teams.device.total.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of device usage of both licensed and non-licensed users.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: teams
        - uuid: a71fb7e8da9e4882bcb5440b5b475a31
          name: 'Teams: Device usage (total), web client'
          type: DEPENDENT
          key: ms365.teams.device.total.web
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams web client over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].web'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 68c3b651d315491db16222fd8aa96237
          name: 'Teams: Device usage (total), Windows'
          type: DEPENDENT
          key: ms365.teams.device.total.windows
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique Microsoft Teams users (licensed or non-licensed) recorded via the Teams desktop client on a Windows-based computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionTotalUserCounts[0].windows'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: d25d13138a7f4690825549476a32d3ec
          name: 'Teams: Device usage (users), Android'
          type: DEPENDENT
          key: ms365.teams.device.users.android
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams mobile client for Android over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].androidPhone'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: fbdad9980995479da7d5413a55c18ef3
          name: 'Teams: Device usage (users), Chrome OS'
          type: DEPENDENT
          key: ms365.teams.device.users.chromeos
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams desktop client on a ChromeOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].chromeOS'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: b8274b598bb34488b6bd8f1bb9e3dbca
          name: 'Teams: Device usage (users), iOS'
          type: DEPENDENT
          key: ms365.teams.device.users.ios
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams mobile client for iOS over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].ios'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 24de6354c4b04c7aa5ad12bfb8858800
          name: 'Teams: Device usage (users), Linux'
          type: DEPENDENT
          key: ms365.teams.device.users.linux
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams desktop client on a Linux computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].linux'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: 1037aa5c3bf14114b6f1aaf61c3a4ea3
          name: 'Teams: Device usage (users), Mac'
          type: DEPENDENT
          key: ms365.teams.device.users.mac
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams desktop client on a macOS computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].mac'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: e95474426572429cb795648aeae3881a
          name: 'Teams: Device usage (users), web client'
          type: DEPENDENT
          key: ms365.teams.device.users.web
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams web client over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].web'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: c7d6439dbb394b66949050e00205995e
          name: 'Teams: Device usage (users), Windows'
          type: DEPENDENT
          key: ms365.teams.device.users.windows
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of unique licensed Microsoft Teams users recorded via the Teams desktop client on a Windows-based computer over the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsDeviceUsageDistributionUserCounts[0].windows'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: device
            - tag: component
              value: teams
        - uuid: aca93ce9a84d4cd5a2465dd43ce47156
          name: 'Teams: Get errors'
          type: DEPENDENT
          key: ms365.teams.errors
          delay: '0'
          history: 7d
          trends: '0'
          value_type: TEXT
          description: 'A list of errors from API requests for Teams metrics.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: error
            - tag: component
              value: teams
          triggers:
            - uuid: 18c8af3eea6f49b1ba795b476e218ab9
              expression: 'length(last(/Microsoft 365 reports by HTTP/ms365.teams.errors))>0'
              name: 'Teams: There are errors in requests to API'
              opdata: '{ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Zabbix has received errors in response to API requests.'
              tags:
                - tag: scope
                  value: availability
        - uuid: a77e654c05ec44ed991a36c6b1df472f
          name: 'Teams: Get reports'
          type: SCRIPT
          key: ms365.teams.reports.get
          delay: 6h
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            const ms365 = {
            	params: {},
            	token: null,
            
            	setParams: function (params) {
            		['app_id', 'password', 'tenant_id'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		ms365.params = params;
            	},
            
            	login: function () {
            		const response = new HttpRequest(),
            			login = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			login.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		login.addHeader('Content-Type: application/x-www-form-urlencoded');
            
            		response = login.post(
            			'https://login.microsoftonline.com/' + encodeURIComponent(ms365.params.tenant_id) + '/oauth2/v2.0/token',
            			'grant_type=client_credentials&scope=https://graph.microsoft.com/.default&client_id=' + encodeURIComponent(ms365.params.app_id) + '&client_secret=' + encodeURIComponent(ms365.params.password)
            		);
            
            		if (login.getStatus() < 200 || login.getStatus() >= 300) {
            			throw 'Login failed with status code ' + login.getStatus() + ': ' + response;
            		}
            
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse login session response.';
            		}
            
            		if (!response.hasOwnProperty('access_token')) {
            			throw 'Authentication response does not contain access token.';
            		}
            
            		ms365.token = response['access_token'];
            	},
            
            	request: function (url) {
            		const response = new HttpRequest(),
            			request = new HttpRequest();
            
            		if (typeof ms365.params.http_proxy !== 'undefined' && ms365.params.http_proxy !== '') {
            			request.setProxy(ms365.params.http_proxy);
            			Zabbix.log(4, '[ Microsoft 365 ] Using HTTP proxy: ' + ms365.params.http_proxy);
            		}
            
            		if (!ms365.token) {
            			throw 'Request does not contain access token.';
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Bearer ' + ms365.token);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Request url: ' + url);
            
            		response = request.get(url);
            
            		Zabbix.log(4, '[ Microsoft 365 ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() < 200 || request.getStatus() >= 300) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            
            		try {
            			return JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from API.';
            		}
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return ms365.nullToZero(data);
            	},
            
            	nullToZero: function (data) {
            		Object.keys(data).forEach(function (key) {
            			if (data[key] === null) {
            				data[key] = 0;
            			} else if (typeof data[key] === 'object') {
            				ms365.nullToZero(data[key]);
            			}
            		});
            
            		return data;
            	},
            
            	getMetricsData: function (endpoints) {
            		const data = {};
            
            		data.metrics = {};
            		endpoints.forEach(function (field) {
            			link = 'https://graph.microsoft.com/beta/reports/' + field + '(period=\'D7\')?$format=application/json';
            			answer = ms365.getField(ms365.request(link), 'value');
            
            			data.metrics[field] = answer;
            		});
            
            		return data;
            	},
            
            	getServiceData: function () {
            		var data = {},
            
            		link = 'https://graph.microsoft.com/beta/admin/serviceAnnouncement/healthOverviews/';
            		data.services = ms365.request(link);
            
            		return data;
            	}
            };
            
            
            endpoints = [
            	'getTeamsDeviceUsageDistributionUserCounts',
            	'getTeamsDeviceUsageDistributionTotalUserCounts',
            	'getTeamsUserActivityTotalDistributionCounts',
            	'getTeamsUserActivityDistributionUserCounts',
            	'getTeamsUserActivityDistributionTotalUserCounts',
            	'getTeamsTeamActivityDistributionCounts'
            ];
            
            try {
            	ms365.setParams(JSON.parse(value));
            	ms365.login();
            	return JSON.stringify(ms365.getMetricsData(endpoints));
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ Microsoft 365 ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
            
          description: |
            Accumulated data from the Microsoft Graph API "reports" endpoints.
            More information:
            https://learn.microsoft.com/en-us/graph/api/resources/report?view=graph-rest-beta
          timeout: '{$MS365.API.TIMEOUT}'
          parameters:
            - name: app_id
              value: '{$MS365.APP.ID}'
            - name: password
              value: '{$MS365.PASSWORD}'
            - name: proxy
              value: '{$MS365.HTTP.PROXY}'
            - name: tenant_id
              value: '{$MS365.TENANT.ID}'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: teams
        - uuid: 7e67ccc2a42c4d5abbc3e0d0d7984d05
          name: 'Teams: User count (guests), calls'
          type: DEPENDENT
          key: ms365.teams.user_count.guests.calls
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of non-licensed Microsoft Teams users (guests) who participated in calls during the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].calls - data.metrics.getTeamsUserActivityDistributionUserCounts[0].calls;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: ddc63a611a24420db83976ccd1a6c8a0
          name: 'Teams: User count (guests), meetings'
          type: DEPENDENT
          key: ms365.teams.user_count.guests.meetings
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of non-licensed Microsoft Teams users (guests) who participated in meetings during the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].meetings - data.metrics.getTeamsUserActivityDistributionUserCounts[0].meetings;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 6907e19e2e8042faaf60b55fd7298e22
          name: 'Teams: User count (guests), team chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.guests.messages.in_team
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of non-licensed Microsoft Teams users (guests) who posted or replied in team chats during the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].teamChatMessages - data.metrics.getTeamsUserActivityDistributionUserCounts[0].teamChatMessages;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: f91e43ecd3874b0ba51d0bca9c2a4bd2
          name: 'Teams: User count (guests), private chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.guests.messages.private
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of non-licensed Microsoft Teams users (guests) who posted or replied in private chats during the week before the report refresh date.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data=JSON.parse(value);
                  
                  return data.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].privateChatMessages - data.metrics.getTeamsUserActivityDistributionUserCounts[0].privateChatMessages;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 79caf6821ff84df5b20ab9c56e25423c
          name: 'Teams: User count (total), calls'
          type: DEPENDENT
          key: ms365.teams.user_count.total.calls
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed or non-licensed Microsoft Teams users who participated in calls during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].calls'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 6d1c327b01ec44188f2693aac595a4d9
          name: 'Teams: User count (total), meetings'
          type: DEPENDENT
          key: ms365.teams.user_count.total.meetings
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed or non-licensed Microsoft Teams users who participated in meetings during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].meetings'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: e594430f98cd442d8ca7705320c35ff9
          name: 'Teams: User count (total), team chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.total.messages.in_team
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed or non-licensed Microsoft Teams users who posted or replied in team chats during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].teamChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: b83cb233a3464734873ac5c1fb62c3c2
          name: 'Teams: User count (total), private chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.total.messages.private
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed or non-licensed Microsoft Teams users who posted or replied in private chats during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].privateChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 34dcf8e943644be8b82691d845ea2f40
          name: 'Teams: User count (total), report date'
          type: DEPENDENT
          key: ms365.teams.user_count.total.report_date
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'The date of the report of the number of licensed or non-licensed Microsoft Teams users in activity.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionTotalUserCounts[0].reportRefreshDate'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: date
            - tag: component
              value: teams
        - uuid: 47348e11d1d646c88330853b8e002143
          name: 'Teams: User count (users), calls'
          type: DEPENDENT
          key: ms365.teams.user_count.users.calls
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed Microsoft Teams users who participated in calls during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionUserCounts[0].calls'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 68b1c4eaf0864acd81cc7f79f41eeec6
          name: 'Teams: User count (users), meetings'
          type: DEPENDENT
          key: ms365.teams.user_count.users.meetings
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed Microsoft Teams users who participated in meetings during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionUserCounts[0].meetings'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 0f9486c175254cbf9a1b3f7cdd98b594
          name: 'Teams: User count (users), team chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.users.messages.in_team
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed Microsoft Teams users who posted or replied in team chats during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionUserCounts[0].teamChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
        - uuid: 86ebe049e2264190b166c71189e6183d
          name: 'Teams: User count (users), private chat messages'
          type: DEPENDENT
          key: ms365.teams.user_count.users.messages.private
          delay: '0'
          history: 7d
          trends: '0'
          description: 'The number of licensed Microsoft Teams users who posted or replied in private chats during the week before the report refresh date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.getTeamsUserActivityDistributionUserCounts[0].privateChatMessages'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: ms365.teams.reports.get
          tags:
            - tag: component
              value: teams
      discovery_rules:
        - uuid: f28e588e81fa4fbdaeb65463843c2c1d
          name: 'Microsoft cloud service discovery'
          type: DEPENDENT
          key: ms365.service.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$MS365.SERVICE.NAME.MATCHES}'
                formulaid: A
              - macro: '{#NAME}'
                value: '{$MS365.SERVICE.NAME.NOT.MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'The list of Microsoft cloud services subscribed by a tenant.'
          item_prototypes:
            - uuid: 0cfd7176865a4c3c8c78c536a792c336
              name: 'Services: {#NAME} health status'
              type: DEPENDENT
              key: 'ms365.service.health[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                Overall service health status of `[{#NAME}]`.
                More information about health status values can be found here:
                https://learn.microsoft.com/en-us/graph/api/resources/servicehealthissue?view=graph-rest-beta#servicehealthstatus-values
              valuemap:
                name: 'Services health status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.services.value[?(@.service == ''{#NAME}'')].status.first()'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value !== 'null') {
                        const idx = [
                      	'serviceOperational',
                      	'investigating',
                      	'restoringService',
                      	'verifyingService',
                      	'serviceRestored',
                      	'postIncidentReviewPublished',
                      	'serviceDegradation',
                      	'serviceInterruption',
                      	'extendedRecovery',
                      	'falsePositive',
                      	'investigationSuspended',
                      	].indexOf(value);
                      
                      	return idx !== -1 ? idx : 11;
                      	}
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: ms365.services.get
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: service
                - tag: service
                  value: '{#NAME}'
              trigger_prototypes:
                - uuid: eaf40afe3cbf402f8148913e9b7baf98
                  expression: 'last(/Microsoft 365 reports by HTTP/ms365.service.health[{#NAME}])=6'
                  name: 'MS365: Services: {#NAME} is degraded.'
                  opdata: '{ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    The service has the "Degraded" health status.
                    An issue is confirmed that may affect the use of a service or feature. You might see this status if a service is performing slower than usual, there are intermittent interruptions, or if a feature isn't working.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: health
                - uuid: 312dc15bd57b49dfb86a5185b6c2cefa
                  expression: 'last(/Microsoft 365 reports by HTTP/ms365.service.health[{#NAME}])=7'
                  name: 'MS365: Services: {#NAME} is interrupted.'
                  opdata: '{ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    The service has the "Interruption" health status.
                    An issue was determined that affects users being able to access the service. In this case, the issue is significant and can be reproduced consistently.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: health
          master_item:
            key: ms365.services.get
          lld_macro_paths:
            - lld_macro: '{#NAME}'
              path: $.service
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.services.value
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
      tags:
        - tag: class
          value: application
        - tag: target
          value: ms365
      macros:
        - macro: '{$MS365.API.TIMEOUT}'
          value: 15s
          description: 'API response timeout.'
        - macro: '{$MS365.APP.ID}'
          description: 'Microsoft application ID.'
        - macro: '{$MS365.HTTP.PROXY}'
          description: 'Sets the HTTP proxy value. If this macro is empty, then no proxy is used.'
        - macro: '{$MS365.PASSWORD}'
          type: SECRET_TEXT
          description: 'The secret for the registered Microsoft application.'
        - macro: '{$MS365.SERVICE.NAME.MATCHES}'
          value: '.*'
          description: 'This macro is used in the Microsoft cloud service discovery rule.'
        - macro: '{$MS365.SERVICE.NAME.NOT.MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'This macro is used in the Microsoft cloud service discovery rule.'
        - macro: '{$MS365.TENANT.ID}'
          description: 'Microsoft tenant ID.'
      dashboards:
        - uuid: 8c376826b58546b184f03415a5fedd46
          name: 'Microsoft 365'
          display_period: '120'
          pages:
            - name: Apps
              widgets:
                - type: ITEM
                  name: 'Report date'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.apps.users.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, by app'
                  'y': '2'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Users, by app, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '5'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.apps.platform.user_count.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, by platform'
                  'y': '7'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Platform, user count, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '10'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.apps.office.user_count.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, by office app'
                  'y': '12'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Office, user count, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '15'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.apps.activity.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly active user count, by app'
                  'y': '17'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Weekly active user count, by app, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '20'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.apps.activity.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly inactive user count, by app'
                  'y': '22'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Weekly inactive user count, by app, pie'
                - type: GRAPH_CLASSIC
                  name: 'User count, by app'
                  x: '4'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Users, by app'
                - type: GRAPH_CLASSIC
                  name: 'User count, by platform'
                  x: '4'
                  'y': '5'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Platform, user count'
                - type: GRAPH_CLASSIC
                  name: 'User count, by office app'
                  x: '4'
                  'y': '10'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Office, user count'
                - type: GRAPH_CLASSIC
                  name: 'Weekly active user count, by app'
                  x: '4'
                  'y': '15'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Weekly active user count, by app'
                - type: GRAPH_CLASSIC
                  name: 'Weekly inactive user count, by app'
                  x: '4'
                  'y': '20'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Apps: Weekly inactive user count, by app'
            - name: Teams
              widgets:
                - type: ITEM
                  name: 'Report date'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.user.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly user activity count'
                  'y': '2'
                  width: '4'
                  height: '5'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Weekly user activity count, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '7'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.device.total.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly unique users, by device type'
                  'y': '9'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Device usage (total), by device type, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '12'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.user_count.total.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly unique users, by action'
                  'y': '14'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: User count (total), by activity, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '17'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.team.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly team activity count'
                  'y': '19'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Team activity, 1 of 2, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '22'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.team.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly team activity count'
                  'y': '24'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Team activity, 2 of 2, pie'
                - type: ITEM
                  name: 'Weekly private messages'
                  x: '4'
                  width: '5'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.user.messages.private
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Weekly user activity count'
                  x: '4'
                  'y': '2'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Weekly user activity count'
                - type: GRAPH_CLASSIC
                  name: 'Weekly unique users, by device type'
                  x: '4'
                  'y': '7'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Device usage (total), by device type'
                - type: GRAPH_CLASSIC
                  name: 'Weekly unique users, by action'
                  x: '4'
                  'y': '12'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: User count (total), by activity'
                - type: GRAPH_CLASSIC
                  name: 'Weekly team activity count'
                  x: '4'
                  'y': '17'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Team activity, 1 of 2'
                - type: GRAPH_CLASSIC
                  name: 'Weekly team activity count'
                  x: '4'
                  'y': '22'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Teams: Team activity, 2 of 2'
                - type: ITEM
                  name: 'Weekly audio duration'
                  x: '9'
                  width: '5'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.user.duration.audio
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: ITEM
                  name: 'Weekly video duration'
                  x: '14'
                  width: '5'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.user.duration.video
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: ITEM
                  name: 'Weekly screen share duration'
                  x: '19'
                  width: '5'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.teams.activity.user.duration.screen_share
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '50'
            - name: Outlook
              widgets:
                - type: ITEM
                  name: 'Report date'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.activity.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Emails sent/received/read'
                  'y': '4'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: Activity, emails sent/receive/read, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '7'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.activity.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Meetings created/interacted'
                  'y': '9'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: Activity, meetings created/interacted, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '12'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.user_count.report_date.app
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, by app/platform'
                  'y': '14'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, app usage, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '17'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.user_count.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, by activity'
                  'y': '19'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, emails sent/receive/read, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '22'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.user_count.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, meetings'
                  'y': '24'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, meetings created/interacted, pie'
                - type: ITEM
                  name: 'Active mailboxes'
                  x: '4'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.mailbox.active.percentage
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: GRAPH_CLASSIC
                  name: 'Emails sent/received/read'
                  x: '4'
                  'y': '2'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: Activity, emails sent/receive/read'
                - type: GRAPH_CLASSIC
                  name: 'Meetings created/interacted'
                  x: '4'
                  'y': '7'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: Activity, meetings created/interacted'
                - type: GRAPH_CLASSIC
                  name: 'User count, by app/platform'
                  x: '4'
                  'y': '12'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, app usage'
                - type: GRAPH_CLASSIC
                  name: 'User count, by activity'
                  x: '4'
                  'y': '17'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, emails sent/receive/read'
                - type: GRAPH_CLASSIC
                  name: 'User count, meetings'
                  x: '4'
                  'y': '22'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'Outlook: User count, meetings created/interacted'
                - type: ITEM
                  name: 'Total mailboxes'
                  x: '8'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.mailbox.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'Total storage used'
                  x: '12'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.outlook.storage.used
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
            - name: OneDrive
              widgets:
                - type: ITEM
                  name: 'Report date'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.files.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'Files shared/synced/viewed or edited'
                  'y': '4'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'OneDrive: Files, activity, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '7'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.users.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'User count, file activity'
                  'y': '9'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'OneDrive: Users, activity, pie'
                - type: ITEM
                  name: 'Business site count (active)'
                  x: '4'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.sites.active
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: GRAPH_CLASSIC
                  name: 'Files shared/synced/viewed or edited'
                  x: '4'
                  'y': '2'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'OneDrive: Files, activity'
                - type: GRAPH_CLASSIC
                  name: 'User count, file activity'
                  x: '4'
                  'y': '7'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'OneDrive: Users, activity'
                - type: ITEM
                  name: 'Business site count (total)'
                  x: '8'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.sites.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'File count (active)'
                  x: '12'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.file_count.active
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'File count (total)'
                  x: '16'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.file_count.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'Total storage used'
                  x: '20'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.onedrive.storage.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
            - name: SharePoint
              widgets:
                - type: ITEM
                  name: 'Pages, view count'
                  width: '3'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.pages_viewed.count
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'Report date'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.files.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'File count, by action'
                  'y': '4'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'SharePoint: Files, activity, pie'
                - type: ITEM
                  name: 'Report date'
                  'y': '7'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.user_count.report_date
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '50'
                - type: GRAPH_CLASSIC
                  name: 'File count, by action'
                  'y': '9'
                  width: '4'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'SharePoint: Users, activity, pie'
                - type: ITEM
                  name: 'Pages, visited'
                  x: '3'
                  width: '3'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.pages_visited.count
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: GRAPH_CLASSIC
                  name: 'File count, by action'
                  x: '4'
                  'y': '2'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'SharePoint: Files, activity'
                - type: GRAPH_CLASSIC
                  name: 'File count, by action'
                  x: '4'
                  'y': '7'
                  width: '20'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        name: 'SharePoint: Users, activity'
                - type: ITEM
                  name: 'Business site count (active)'
                  x: '6'
                  width: '3'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.sites.active
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'Business site count (total)'
                  x: '9'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.sites.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'File count (active)'
                  x: '13'
                  width: '3'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.file_count.active
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'File count (total)'
                  x: '16'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.file_count.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
                - type: ITEM
                  name: 'Total storage used'
                  x: '20'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: down_color
                      value: FF465C
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'Microsoft 365 reports by HTTP'
                        key: ms365.sharepoint.storage.total
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '4'
                    - type: STRING
                      name: updown_color
                      value: FFD54F
                    - type: STRING
                      name: up_color
                      value: 0EC9AC
                    - type: INTEGER
                      name: value_size
                      value: '70'
      valuemaps:
        - uuid: cb431f0185884aabae7d46890926e724
          name: 'Services health status'
          mappings:
            - value: '0'
              newvalue: Operational
            - value: '1'
              newvalue: Investigating
            - value: '2'
              newvalue: Restoring
            - value: '3'
              newvalue: Verifying
            - value: '4'
              newvalue: Restored
            - value: '5'
              newvalue: 'Review published'
            - value: '6'
              newvalue: Degraded
            - value: '7'
              newvalue: Interruption
            - value: '8'
              newvalue: 'Extended recovery'
            - value: '9'
              newvalue: 'False positive'
            - value: '10'
              newvalue: 'Investigation suspended'
            - value: '11'
              newvalue: Unknown
  graphs:
    - uuid: 31bda44b06aa4776b9827c07c084be32
      name: 'Apps: Office, user count'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.outlook
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.word
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.excel
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.powerpoint
        - sortorder: '4'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.onenote
        - sortorder: '5'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.teams
    - uuid: 339863988d4d4320b530951b36ea8a90
      name: 'Apps: Office, user count, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.outlook
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.word
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.excel
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.powerpoint
        - sortorder: '4'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.onenote
        - sortorder: '5'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.office.user_count.teams
    - uuid: 0d20b6626d4e4a99ac7822d2d5bbb0fa
      name: 'Apps: Platform, user count'
      graph_items:
        - color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.windows
        - sortorder: '1'
          color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.mac
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.mobile
        - sortorder: '3'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.web
    - uuid: 90d2f30faf1d429dad2e5d16c3872979
      name: 'Apps: Platform, user count, pie'
      type: PIE
      graph_items:
        - color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.windows
        - sortorder: '1'
          color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.mac
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.mobile
        - sortorder: '3'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.platform.user_count.web
    - uuid: ce9d576ef0c04c6a80a00b4095b2ed44
      name: 'Apps: Users, by app'
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.office365
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.exchange
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.onedrive
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.sharepoint
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.skype
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.yammer
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.teams
    - uuid: 2b976b35e8e74200be752089c71583db
      name: 'Apps: Users, by app, pie'
      type: PIE
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.office365
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.exchange
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.onedrive
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.sharepoint
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.skype
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.yammer
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.users.teams
    - uuid: f562a53823bb4616a0aaaa2fa5dfaf89
      name: 'Apps: Weekly active user count, by app'
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.office365.users.active
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.exchange.users.active
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.onedrive.users.active
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.sharepoint.users.active
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.skypeforbusiness.users.active
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.yammer.users.active
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.teams.users.active
    - uuid: 662b79b896214e7fbf53a273153297c1
      name: 'Apps: Weekly active user count, by app, pie'
      type: PIE
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.office365.users.active
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.exchange.users.active
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.onedrive.users.active
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.sharepoint.users.active
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.skypeforbusiness.users.active
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.yammer.users.active
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.teams.users.active
    - uuid: 96a02bde44064e9c991556b8bc32f521
      name: 'Apps: Weekly inactive user count, by app'
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.office365.users.inactive
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.exchange.users.inactive
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.onedrive.users.inactive
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.sharepoint.users.inactive
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.skypeforbusiness.users.inactive
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.yammer.users.inactive
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.teams.users.inactive
    - uuid: b4935da1c66d452fa7f073b914bb014c
      name: 'Apps: Weekly inactive user count, by app, pie'
      type: PIE
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.office365.users.inactive
        - sortorder: '1'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.exchange.users.inactive
        - sortorder: '2'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.onedrive.users.inactive
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.sharepoint.users.inactive
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.skypeforbusiness.users.inactive
        - sortorder: '5'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.yammer.users.inactive
        - sortorder: '6'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.apps.activity.teams.users.inactive
    - uuid: d7ba1bdfe6534c27a0d01cf9a84c7eb6
      name: 'OneDrive: Business sites, active/total'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.sites.total
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.sites.active
    - uuid: 88b75a01c7b541eca8480d821508e9db
      name: 'OneDrive: File count, active/total'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.file_count.total
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.file_count.active
    - uuid: 4d7df5535bf24a3bbe69b823be31bbcf
      name: 'OneDrive: Files, activity'
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.shared_externally
    - uuid: bee74f5489674a5d9a3c97c277e4d847
      name: 'OneDrive: Files, activity, pie'
      type: PIE
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.files.shared_externally
    - uuid: 6975a23a719f40f2928468331f004617
      name: 'OneDrive: Users, activity'
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.shared_externally
    - uuid: 1d6aa602c2b04a2e931fbbed095e3e0f
      name: 'OneDrive: Users, activity, pie'
      type: PIE
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.onedrive.users.shared_externally
    - uuid: 167557c1299e42d4bf514544ca248bab
      name: 'Outlook: Activity, emails sent/receive/read'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.sent
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.received
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.read
    - uuid: 015f42b44bab40e0a8fac0a2d944188f
      name: 'Outlook: Activity, emails sent/receive/read, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.sent
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.received
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.read
    - uuid: 62ecec3ead3b4fbda519e34cd2f7e59f
      name: 'Outlook: Activity, meetings created/interacted'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.meetings_created
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.meetings_interacted
    - uuid: 3f4fa3dfa10a440cb80eda3150c8be80
      name: 'Outlook: Activity, meetings created/interacted, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.meetings_created
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.activity.meetings_interacted
    - uuid: 410245360e6b4b8abc5578a9fea9aed9
      name: 'Outlook: Mailbox, active/total'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.mailbox.total
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.mailbox.active
    - uuid: e5495197b747402f840a0a36fc2d3822
      name: 'Outlook: User count, app usage'
      graph_items:
        - color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mail_for_mac
        - sortorder: '1'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mac
        - sortorder: '2'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.windows
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mobile
        - sortorder: '4'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.web
        - sortorder: '5'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.pop3app
        - sortorder: '6'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.imap4app
        - sortorder: '7'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.smtpapp
    - uuid: ca90e01f16fa4817b31946905ccc8087
      name: 'Outlook: User count, app usage, pie'
      type: PIE
      graph_items:
        - color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mail_for_mac
        - sortorder: '1'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mac
        - sortorder: '2'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.windows
        - sortorder: '3'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.mobile
        - sortorder: '4'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.web
        - sortorder: '5'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.pop3app
        - sortorder: '6'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.imap4app
        - sortorder: '7'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.smtpapp
    - uuid: 1820edb683844f5ba7aab911314f9148
      name: 'Outlook: User count, emails sent/receive/read'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.sent
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.received
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.read
    - uuid: b93e69a038934e44a6c058745a2f063d
      name: 'Outlook: User count, emails sent/receive/read, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.sent
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.received
        - sortorder: '2'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.read
    - uuid: 2bc072171a974632ac16f17c55a6e6db
      name: 'Outlook: User count, meetings created/interacted'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.meetings_created
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.meetings_interacted
    - uuid: 940d8c5662c446e1ae12153f55537c87
      name: 'Outlook: User count, meetings created/interacted, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.meetings_created
        - sortorder: '1'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.outlook.user_count.meetings_interacted
    - uuid: 368ccbec6efc4be0acafc376bed02c86
      name: 'SharePoint: File count, active/total'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.file_count.total
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.file_count.active
    - uuid: 8b74bc9ef37f4126b5c2e570c674c101
      name: 'SharePoint: Files, activity'
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.shared_externally
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.file_count.active
    - uuid: ca6f0043742f4feabc3031bec6dc4b49
      name: 'SharePoint: Files, activity, pie'
      type: PIE
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.files.shared_externally
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.file_count.active
    - uuid: d56dec11b20d40adb288f54799d52626
      name: 'SharePoint: Sites, active/total'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.sites.total
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.sites.active
    - uuid: e904e8075548406c8eea9a5576817ef1
      name: 'SharePoint: Users, activity'
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.shared_externally
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.visited_page
    - uuid: 8ab16381213743f982e8fb77d092a320
      name: 'SharePoint: Users, activity, pie'
      type: PIE
      graph_items:
        - color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.viewed_or_edited
        - sortorder: '1'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.synced
        - sortorder: '2'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.shared_internally
        - sortorder: '3'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.shared_externally
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.sharepoint.user_count.visited_page
    - uuid: 2c9b134db13844f59054cc81b2135edc
      name: 'Teams: Device usage (guests), by device type'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.web
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.android
        - sortorder: '2'
          color: 00611C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.ios
        - sortorder: '3'
          color: F7941D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.mac
        - sortorder: '4'
          color: FC6EA3
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.windows
        - sortorder: '5'
          color: 6C59DC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.chromeos
        - sortorder: '6'
          color: C7A72D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.guests.linux
    - uuid: e2c59d05b05c4a32aa027cfb6d2c2f67
      name: 'Teams: Device usage (total), by device type'
      graph_items:
        - color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.web
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.android
        - sortorder: '2'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.ios
        - sortorder: '3'
          color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.mac
        - sortorder: '4'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.windows
        - sortorder: '5'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.chromeos
        - sortorder: '6'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.linux
    - uuid: 63801bc7726d477486d8c33e7edc303f
      name: 'Teams: Device usage (total), by device type, pie'
      type: PIE
      graph_items:
        - color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.web
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.android
        - sortorder: '2'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.ios
        - sortorder: '3'
          color: B4B400
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.mac
        - sortorder: '4'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.windows
        - sortorder: '5'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.chromeos
        - sortorder: '6'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.total.linux
    - uuid: 072347b5896d477ea875520211e7d71b
      name: 'Teams: Device usage (users), by device type'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.web
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.android
        - sortorder: '2'
          color: 00611C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.ios
        - sortorder: '3'
          color: F7941D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.mac
        - sortorder: '4'
          color: FC6EA3
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.windows
        - sortorder: '5'
          color: 6C59DC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.chromeos
        - sortorder: '6'
          color: C7A72D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.device.users.linux
    - uuid: 4c778638ac2f43d6a2e80f61d5014906
      name: 'Teams: Team activity, 1 of 2'
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.channel_messages
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.mentions
        - sortorder: '2'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.messages.posts
        - sortorder: '3'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.reactions
        - sortorder: '4'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.messages.replies
        - sortorder: '5'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.urgent_messages
    - uuid: ae498ed709634563b9284d68b020517f
      name: 'Teams: Team activity, 1 of 2, pie'
      type: PIE
      graph_items:
        - color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.channel_messages
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.mentions
        - sortorder: '2'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.messages.posts
        - sortorder: '3'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.reactions
        - sortorder: '4'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.messages.replies
        - sortorder: '5'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.urgent_messages
    - uuid: 99087ab347d74eebaf736128312278d3
      name: 'Teams: Team activity, 2 of 2'
      graph_items:
        - color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_channels
        - sortorder: '1'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_external_users
        - sortorder: '2'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_shared_channels
        - sortorder: '3'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_users
        - sortorder: '4'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.guests
        - sortorder: '5'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.meetings_organized
    - uuid: 2dbbc250a7764f8b93ac1609f6770d4b
      name: 'Teams: Team activity, 2 of 2, pie'
      type: PIE
      graph_items:
        - color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_channels
        - sortorder: '1'
          color: 6AC8FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_external_users
        - sortorder: '2'
          color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_shared_channels
        - sortorder: '3'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.active_users
        - sortorder: '4'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.guests
        - sortorder: '5'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.team.meetings_organized
    - uuid: 7535ecb32e0147d686562ba988d3c655
      name: 'Teams: User activity, audio/video/screen share duration'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.duration.audio
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.duration.video
        - sortorder: '2'
          color: 00611C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.duration.screen_share
    - uuid: fcb3abcbd08b48db85b065ebf90ae9b8
      name: 'Teams: User count (total), by activity'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.messages.in_team
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.messages.private
        - sortorder: '2'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.calls
        - sortorder: '3'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.meetings
    - uuid: e0d31314c9fc41ceab9f678601ebda5c
      name: 'Teams: User count (total), by activity, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.messages.in_team
        - sortorder: '1'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.messages.private
        - sortorder: '2'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.calls
        - sortorder: '3'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.user_count.total.meetings
    - uuid: 5d328902c88f431fa4459f59f00c9180
      name: 'Weekly user activity count'
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.in_team
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.calls
        - sortorder: '2'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.total
        - sortorder: '3'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.organized
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.attended
        - sortorder: '5'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.posts
        - sortorder: '6'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.replies
    - uuid: 2b911401755544de93056663c196ef0c
      name: 'Weekly user activity count, pie'
      type: PIE
      graph_items:
        - color: 2AB5FF
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.in_team
        - sortorder: '1'
          color: FF465C
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.calls
        - sortorder: '2'
          color: FFD54F
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.total
        - sortorder: '3'
          color: 524BBC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.organized
        - sortorder: '4'
          color: 385CC7
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.meetings.attended
        - sortorder: '5'
          color: 0EC9AC
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.posts
        - sortorder: '6'
          color: BAE37D
          item:
            host: 'Microsoft 365 reports by HTTP'
            key: ms365.teams.activity.user.messages.replies
